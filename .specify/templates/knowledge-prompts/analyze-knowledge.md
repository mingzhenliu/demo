# /speckit.analyze 知识库注入模板

> 用于在执行 /speckit.analyze 命令时注入相关知识库文档

## 知识库上下文

### 架构原则 (L0)

以下是企业架构原则，用于宪章合规性分析：

```markdown
{ARCHITECTURE_PRINCIPLES_CONTENT}
```

---

### 安全基线 (L0)

以下是安全基线要求，用于安全合规性分析：

```markdown
{SECURITY_BASELINE_CONTENT}
```

---

### 术语词典 (L1)

以下是项目标准术语词典，用于术语一致性分析：

```markdown
{GLOSSARY_CONTENT}
```

---

## 分析维度

### 1. 术语一致性分析

检查 spec.md、plan.md、tasks.md 中的术语使用：

| 检查项 | 描述 |
|--------|------|
| 标准术语 | 是否使用 glossary.md 中定义的术语 |
| 术语一致 | 同一概念在各文档中是否使用相同术语 |
| 新术语 | 是否有未定义的新术语需要补充 |

### 2. 宪章合规分析

检查 plan.md 是否符合架构原则：

| 原则 | 检查要点 |
|------|----------|
| TDD | 测试策略是否在实施前定义 |
| 分层架构 | 代码组织是否符合分层结构 |
| 单一职责 | 模块划分是否合理 |
| 接口隔离 | API 设计是否精简 |

### 3. 安全合规分析

检查 plan.md 和 tasks.md 是否满足安全基线：

| 检查项 | 描述 |
|--------|------|
| 输入校验 | 是否规划了输入验证任务 |
| 认证授权 | 是否考虑了访问控制 |
| 审计日志 | 是否规划了日志记录 |
| 数据保护 | 敏感数据是否有保护措施 |

### 4. 跨产物一致性

检查各产物之间的一致性：

| 关系 | 检查要点 |
|------|----------|
| spec → plan | 计划是否完整覆盖规格需求 |
| plan → tasks | 任务是否完整实现计划 |
| tasks → code | 任务路径是否与代码结构匹配 |

---

## 分析报告模板

```markdown
## 跨产物分析报告

### 1. 术语一致性
- ✅/⚠️/❌ [分析结果]
- 问题列表：[如有]

### 2. 宪章合规性
- ✅/⚠️/❌ [分析结果]
- 违规项：[如有]

### 3. 安全合规性
- ✅/⚠️/❌ [分析结果]
- 风险项：[如有]

### 4. 跨产物一致性
- ✅/⚠️/❌ [分析结果]
- 差异项：[如有]

### 5. 改进建议
[具体建议列表]
```

---

## 加载状态

| 文档 | 级别 | 状态 | Token |
|------|------|------|-------|
| architecture-principles.md | L0 | {ARCH_STATUS} | {ARCH_TOKENS} |
| security-baseline.md | L0 | {SECURITY_STATUS} | {SECURITY_TOKENS} |
| glossary.md | L1 | {GLOSSARY_STATUS} | {GLOSSARY_TOKENS} |

**总计 Token**: {TOTAL_TOKENS}
