# 数据库设计基线规范

**文档级别**: L0企业级强制规范
**适用范围**: 全公司所有项目
**维护方式**: 架构委员会

---

## 1. 命名规范

### 1.1 表命名
- 表名必须使用小写字母和下划线
- 必须以 `t_` 开头
- 使用单数形式
- 禁止使用MySQL保留字

### 1.2 字段命名
- 字段名必须使用小写字母和下划线
- 主键字段统一命名为 `id`
- 外键字段使用 `{关联表}_id` 格式
- 布尔类型使用 `is_` 前缀

### 1.3 索引命名
- 普通索引用 `idx_{表名}_{字段名}`
- 唯一索引用 `uq_{表名}_{字段名}`
- 复合索引用 `idx_{表名}_{字段1}_{字段2}`

---

## 2. 表结构

### 2.1 强制字段
- `id`: BIGINT AUTO_INCREMENT PRIMARY KEY
- `create_time`: DATETIME NOT NULL
- `update_time`: DATETIME NOT NULL

### 2.2 禁止约束
- 禁止使用数据库外键约束
- 禁止使用CHECK约束
- 禁止使用存储过程和触发器

---

## 3. 字段类型

### 3.1 字符串
- VARCHAR必须指定合理长度
- 禁止使用TEXT存储普通字符串
- 禁止使用CHAR存储变长数据

### 3.2 数值
- 金额字段必须使用DECIMAL，禁止使用FLOAT/DOUBLE

### 3.3 时间
- 禁止使用字符串存储时间
- 纯日期字段使用DATE类型，存储格式为 `YYYYMMDD`（如 `20260101`）
- 日期时间字段使用DATETIME类型

### 3.4 布尔值
- 使用BOOLEAN或TINYINT(1)
- 字段名以 `is_` 开头

---

## 4. 索引设计

### 4.1 必须索引
- 外键字段必须创建索引
- 关联查询字段必须创建索引

### 4.2 禁止索引
- 禁止对所有字段创建索引
- 禁止创建重复索引
- 禁止在低区分度字段创建索引

---

## 5. SQL规范

### 5.1 禁止事项
- 禁止使用SELECT *
- 禁止在WHERE中对字段进行函数计算
- 禁止INSERT不带字段名

### 5.2 脚本管理
- DDL语句必须放在schema.sql
- DML语句必须放在data.sql

---

## 6. 安全管理

### 6.1 账号权限
- 禁止使用root账号连接应用
- 禁止使用DROP权限

### 6.2 敏感数据
- 敏感信息必须加密存储
- 密钥与数据分离存储
- 禁止明文存储密码
- 禁止日志输出敏感信息
- 禁止导出生产数据到非生产环境

---

## 7. 配置要求

- 必须使用InnoDB引擎
- 必须使用utf8mb4字符集

---

## 8. 版本管理

- 必须使用Flyway或Liquibase进行版本管理
- 禁止直接在生产环境执行SQL
- 开发/测试/生产环境必须使用独立数据库实例

---

## 9. 合规要求

- 跨境数据传输需符合监管要求
- 敏感操作必须记录审计日志
- 禁止未授权访问用户数据

---

## 10. 备份恢复

- 生产数据库必须定期备份
- 备份数据必须测试恢复流程

---

**文档版本**: 1.0.0
**生效日期**: 2026-01-19
**维护人**: 架构委员会
